<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>flashplayer</title>
    <script src="./ruffle/ruffle.js"></script>
  </head>

  <body style="margin:0; background:black;">
    <div id="ui" style="padding:0px;">
      <input id="file" type="file" accept=".swf" />
      <button id="fs">Fullscreen</button>
    </div>

    <div id="stage" style="width:100vw; height:calc(100vh - 40px); background:black;"></div>

    <script>
      // Ruffle configuration
      window.RufflePlayer = window.RufflePlayer || {};
      window.RufflePlayer.config = {
        autoplay: "on",
        unmuteOverlay: "visible",

        // Keep correct aspect ratio
        scale: "showAll",
        letterbox: "on",
        backgroundColor: "#000000",
      };

      const stage = document.getElementById("stage");
      const ruffle = window.RufflePlayer.newest();
      const player = ruffle.createPlayer();

      player.style.width = "100%";
      player.style.height = "100%";
      stage.appendChild(player);

      // Load user-selected SWF
      document.getElementById("file").addEventListener("change", async (e) => {
        const file = e.target.files?.[0];
        if (!file) return;

        const url = URL.createObjectURL(file);
        await player.load({ url });
      });

      // Fullscreen toggle
      document.getElementById("fs").addEventListener("click", async () => {
        if (!document.fullscreenElement) {
          await stage.requestFullscreen();
        } else {
          await document.exitFullscreen();
        }
      });
    </script>
  </body>
</html>

